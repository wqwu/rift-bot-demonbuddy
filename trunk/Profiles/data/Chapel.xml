<Profile>

<Name>Cursed Chapel</Name>

<KillMonsters>True</KillMonsters>
<PickupLoot>true</PickupLoot>
<GameParams act="OpenWorld" resumeFromSave="False" isPrivate="True" numGames="-1" />

<Order>
<While condition="CurrentWorldId != 129305">
	<UseWaypoint waypointNumber="45" questId="1"/>
	<WaitTimer questId="1" stepId="1" waitTime="5000"/>
</While>
	<If condition="HasQuest(369878)">
	<If condition="CurrentWorldId == 129305">
	<TrinityExploreDungeon questId="1" stepId="2" until="ObjectFound" objectDistance="300" actorId="365097" boxTolerance="0.01" boxSize="25" ignoreMarkers="False" stayAfterBounty="False">
	<PrioritizeScenes>
        <PriorityScene sceneName="a4dun_spire_corrupt_SE_02" pathPrecision="40" />          
    </PrioritizeScenes>
	</TrinityExploreDungeon >
      <MoveToActor questId="1" stepId="2" actorId="365097"/>
	  <WaitTimer questId="1" stepId="2" waitTime="500" />
		<While condition="ActorExistsAt(364559, Me.Position.X, Me.Position.Y, Me.Position.Z, 150)">
			<MoveToActor questId="1" stepId="2" actorId="365097"/>
		</While>
	  </If>
	</If>
	
	<!-- Duplicate to handle getting interrupted by the other cursed chest, couldn't find a more elegant solution -->
	<If condition="HasQuest(369878)">
	<If condition="CurrentWorldId == 129305">
	<TrinityExploreDungeon questId="1" stepId="2" until="ObjectFound" objectDistance="300" actorId="365097" boxTolerance="0.01" boxSize="25" ignoreMarkers="False" stayAfterBounty="False">
	<PrioritizeScenes>
        <PriorityScene sceneName="a4dun_spire_corrupt_SE_02" pathPrecision="40" />          
    </PrioritizeScenes>
	</TrinityExploreDungeon >
      <MoveToActor questId="1" stepId="2" actorId="365097"/>
	  <WaitTimer questId="1" stepId="2" waitTime="500" />
		<While condition="ActorExistsAt(364559, Me.Position.X, Me.Position.Y, Me.Position.Z, 150)">
			<MoveToActor questId="1" stepId="2" actorId="365097"/>
		</While>
	  </If>
	</If>

	<LoadProfile file="act4.xml" />
</Order>
</Profile>